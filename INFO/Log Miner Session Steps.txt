EXECUTE DBMS_LOGMNR.ADD_LOGFILE('/u02/ARCH/1565-orakic.arc', DBMS_LOGMNR.NEW);

EXECUTE DBMS_LOGMNR.START_LOGMNR('/ora/oracle/logminer/dictionary.ora', TO_DATE('01-Nov-2004 13:00:00', 'DD-MON-YYYY HH:MI:SS'), TO_DATE('01-Nov-2004 14:45:00', 'DD-MON-YYYY HH:MI:SS'));

EXECUTE DBMS_LOGMNR.START_LOGMNR( -
DICTFILENAME =>'/ora/oracle/logminer/dictionary.ora');


EXECUTE DBMS_LOGMNR.START_LOGMNR( -
DICTFILENAME =>'/ora/oracle/logminer/dictionary.ora');

EXECUTE dbms_logmnr.add_logfile('/u02/ARCH/1566-orakic.arc');
EXECUTE dbms_logmnr.add_logfile('/u02/ARCH/1567-orakic.arc');
EXECUTE dbms_logmnr.add_logfile('/u02/ARCH/1568-orakic.arc');
EXECUTE dbms_logmnr.add_logfile('/u02/ARCH/1569-orakic.arc');


execute dbms_logmnr.start_logmnr(2656944,2699283);





SELECT SQL_REDO FROM V$LOGMNR_CONTENTS
WHERE
SEG_NAME = 'pt_policy' AND
SEG_OWNER = 'PREMPROD' AND
OPERATION = 'UPDATE' AND
DBMS_LOGMNR.MINE_VALUE(REDO_VALUE, 'PREMPROD.PT_POLICY.POL_NO') >
2*DBMS_LOGMNR.MINE_VALUE(UNDO_VALUE, 'PREMPROD.PT_POLICY.POL_NO');


EXECUTE DBMS_LOGMNR.PRINT_PRETTY_SQL



SELECT OPERATION, SQL_REDO, SQL_UNDO
FROM V$LOGMNR_CONTENTS
WHERE SEG_OWNER = 'PREMPROD' AND SEG_NAME = 'PT_POLICY' AND
OPERATION = 'UPDATE';


SELECT OPERATION, SQL_REDO, SQL_UNDO
FROM V$LOGMNR_CONTENTS
WHERE SEG_OWNER = 'PREMPROD' AND SEG_NAME = 'PT_POLICY' AND
OPERATION = 'UPDATE' AND
DBMS_LOGMNR.MINE_VALUE(REDO_VALUE, 'PREMPROD.PT_POLICY.POL_NO') >
2*DBMS_LOGMNR.MINE_VALUE(UNDO_VALUE, 'PREMPROD.PT_POLICY.POL_NO');


SELECT operation, sql_redo FROM v$logmnr_contents;

SELECT USERNAME, SQL_REDO
FROM V$LOGMNR_CONTENTS
WHERE USERNAME = 'SYS' AND OEPRATION = 'DDL';



EXECUTE DBMS_LOGMNR.END_LOGMNR;
