--CLEAR SCREEN
SET HEADING OFF
SET LINESIZE 300
SET PAUSE OFF
SET TERMOUT ON
SET SERVEROUTPUT ON
SET FEEDBACK OFF
REM	FUNCTION TO CREATE INDEX MONITORING SCRIPT AND RUN IT
PROMPT
PROMPT Script ran from D:\NABEEL\DBA\SCRIPTS\
PROMPT Script IDX_MON.SQL
PROMPT
PROMPT
PROMPT Monitoring Script will be created in D:\NABEEL\DBA\SCRIPTS\LST AS IDX_STMON.SQL
PROMPT
PROMPT
PROMPT NO Monitoring Script will be created in D:\NABEEL\DBA\SCRIPTS\LST AS IDX_SPMON.SQL
PROMPT
PROMPT
PROMPT CONNECT AS THE OWNER OR WHO HAVE ACCESS TO THE OBJECTS, PROVIDE USERNAME AND PASSWORD 
PROMPT WITH CONNECT STRING . BY DEFAULT IT WILL CONNECT TO DIG AS PREMPROD
PROMPT
PROMPT
--SET TERMOUT OFF
REM
SPOOL D:\NABEEL\DBA\SCRIPTS\LST\IDX_STMON.SQL
REM THIS FILE ALSO COULD BE USED
REM SELECT 'ALTER INDEX '||INDEX_NAME||' MONITORING USAGE;' FROM USER_INDEXES;
REM
REM
SELECT 'ALTER INDEX', OWNER||'.'|| INDEX_NAME, 'MONITORING USAGE ;' FROM DBA_INDEXES
WHERE OWNER IN ('PREMPROD','FINAL7','LIFEPROD');
--WHERE TABLE_NAME LIKE 'PT_RI%';
REM UNcomment this line if want to do monitoring for 1 single user
--WHERE OWNER ='PREMPROD';
SPOOL OFF
REM
REM
SPOOL D:\NABEEL\DBA\SCRIPTS\LST\IDX_SPMON.SQL
REM
SELECT 'ALTER INDEX', OWNER||'.'|| INDEX_NAME, 'NOMONITORING USAGE ;' FROM DBA_INDEXES
WHERE OWNER IN ('PREMPROD','FINAL7','LIFEPROD');
--WHERE TABLE_NAME LIKE 'PT_RI%';
SPOOL OFF
REM
REM
var v_idx  varchar2(4);
   SELECT COUNT(*) INTO  :V_IDX 
   FROM DBA_INDEXES
    WHERE OWNER IN ('PREMPROD','FINAL7','LIFEPROD');
--WHERE TABLE_NAME LIKE 'PT_RI%';
REM
--CONN SYSTEM/MANAGER@DIG
SET SERVEROUT ON
EXECUTE  DBMS_OUTPUT.PUT_LINE('Total Number of Indexex Altered'||'  '||:V_IDX);
REM
@D:\NABEEL\DBA\SCRIPTS\LST\IDX_STMON.SQL;

SET TERMOUT ON
SET HEADING ON
SET PAUSE ON
SET FEEDBACK ON
SHOW USER
